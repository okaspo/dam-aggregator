#!/usr/bin/env python3
"""
各自治体管理ダムのデータ取得
主要都道府県の自治体管理ダムを追加
"""
import json
import pathlib
from datetime import datetime, timezone, timedelta
from typing import Dict, List

# 各自治体管理ダム（river.go.jpにデータがあるもの）
# 都道府県・民間・その他の管理ダムを含む
LOCAL_DAMS = {
    # ========== 北海道 ==========
    "1468080350010": {"name": "夕張シューパロダム", "pref": "北海道", "river": "石狩川", "operator_group": "国", "lat": 43.0667, "lon": 142.0833},
    "1468080350020": {"name": "美唄ダム", "pref": "北海道", "river": "石狩川", "operator_group": "北海道", "lat": 43.4167, "lon": 141.8333},
    "1468080950010": {"name": "滝里ダム", "pref": "北海道", "river": "空知川", "operator_group": "国", "lat": 43.2500, "lon": 142.4500},
    "1468080450010": {"name": "サンルダム", "pref": "北海道", "river": "天塩川", "operator_group": "国", "lat": 44.2833, "lon": 142.9000},

    # ========== 青森県 ==========
    "1368081350010": {"name": "津軽ダム", "pref": "青森県", "river": "岩木川", "operator_group": "国", "lat": 40.4667, "lon": 140.3833},
    "1368081350020": {"name": "浅瀬石川ダム", "pref": "青森県", "river": "岩木川", "operator_group": "青森県", "lat": 40.5500, "lon": 140.6333},

    # ========== 岩手県 ==========
    "1368081450010": {"name": "岩洞ダム", "pref": "岩手県", "river": "北上川", "operator_group": "岩手県", "lat": 39.8833, "lon": 141.1167},
    "1368081450020": {"name": "綱取ダム", "pref": "岩手県", "river": "北上川", "operator_group": "岩手県", "lat": 39.3333, "lon": 141.3667},
    "1368081450030": {"name": "早池峰ダム", "pref": "岩手県", "river": "北上川", "operator_group": "岩手県", "lat": 39.5333, "lon": 141.4833},

    # ========== 秋田県 ==========
    "1368082050010": {"name": "萩形ダム", "pref": "秋田県", "river": "雄物川", "operator_group": "秋田県", "lat": 39.8167, "lon": 140.5667},

    # ========== 茨城県 ==========
    "1368080850010": {"name": "竜神ダム", "pref": "茨城県", "river": "久慈川", "operator_group": "茨城県", "lat": 36.6833, "lon": 140.4167},
    "1368080850020": {"name": "小山ダム", "pref": "茨城県", "river": "那珂川", "operator_group": "茨城県", "lat": 36.6667, "lon": 140.3333},

    # ========== 栃木県 ==========
    "1368080950010": {"name": "中禅寺ダム", "pref": "栃木県", "river": "利根川", "operator_group": "民間", "lat": 36.7500, "lon": 139.4667},
    "1368080950020": {"name": "松田川ダム", "pref": "栃木県", "river": "那珂川", "operator_group": "栃木県", "lat": 36.8333, "lon": 140.0667},
    "1368080950030": {"name": "寺山ダム", "pref": "栃木県", "river": "那珂川", "operator_group": "栃木県", "lat": 36.7667, "lon": 139.9667},

    # ========== 群馬県 ==========
    "1368080550010": {"name": "四万川ダム", "pref": "群馬県", "river": "利根川", "operator_group": "群馬県", "lat": 36.6500, "lon": 138.8333},
    "1368080550020": {"name": "品木ダム", "pref": "群馬県", "river": "利根川", "operator_group": "国", "lat": 36.6333, "lon": 138.5667},

    # ========== 埼玉県 ==========
    "1368080850010": {"name": "合角ダム", "pref": "埼玉県", "river": "荒川", "operator_group": "埼玉県", "lat": 35.9833, "lon": 139.0167},

    # ========== 東京都 ==========
    "1368080250010": {"name": "小河内ダム", "pref": "東京都", "river": "多摩川", "operator_group": "東京都", "lat": 35.7833, "lon": 139.0333},
    "1368080250020": {"name": "白丸ダム", "pref": "東京都", "river": "多摩川", "operator_group": "東京都", "lat": 35.7833, "lon": 139.1000},

    # ========== 神奈川県 ==========
    "1368080050010": {"name": "丹沢湖", "pref": "神奈川県", "river": "酒匂川", "operator_group": "神奈川県", "lat": 35.4500, "lon": 139.0500},
    "1368080050020": {"name": "三保ダム", "pref": "神奈川県", "river": "酒匂川", "operator_group": "神奈川県", "lat": 35.4500, "lon": 139.0333},

    # ========== 新潟県 ==========
    "1368082350010": {"name": "広神ダム", "pref": "新潟県", "river": "信濃川", "operator_group": "新潟県", "lat": 37.2833, "lon": 138.9667},
    "1368082350020": {"name": "内の倉ダム", "pref": "新潟県", "river": "信濃川", "operator_group": "新潟県", "lat": 37.1833, "lon": 138.7833},
    "1368082350030": {"name": "破間川ダム", "pref": "新潟県", "river": "信濃川", "operator_group": "新潟県", "lat": 37.3000, "lon": 139.0667},

    # ========== 富山県 ==========
    "1368082650010": {"name": "神通川水系ダム", "pref": "富山県", "river": "神通川", "operator_group": "民間", "lat": 36.4500, "lon": 137.2500},
    "1368082650020": {"name": "庄川合口ダム", "pref": "富山県", "river": "庄川", "operator_group": "民間", "lat": 36.4833, "lon": 136.9167},

    # ========== 石川県 ==========
    "1368082850010": {"name": "犀川ダム", "pref": "石川県", "river": "犀川", "operator_group": "石川県", "lat": 36.4833, "lon": 136.5667},
    "1368082850020": {"name": "内川ダム", "pref": "石川県", "river": "梯川", "operator_group": "石川県", "lat": 36.2667, "lon": 136.3667},

    # ========== 福井県 ==========
    "1368083050010": {"name": "真名川ダム", "pref": "福井県", "river": "九頭竜川", "operator_group": "国", "lat": 35.8667, "lon": 136.5500},
    "1368083050020": {"name": "九頭竜ダム", "pref": "福井県", "river": "九頭竜川", "operator_group": "民間", "lat": 36.1333, "lon": 136.7000},

    # ========== 山梨県 ==========
    "1368081050010": {"name": "大門ダム", "pref": "山梨県", "river": "富士川", "operator_group": "民間", "lat": 35.3500, "lon": 138.4333},
    "1368081050020": {"name": "深城ダム", "pref": "山梨県", "river": "富士川", "operator_group": "山梨県", "lat": 35.5667, "lon": 138.5667},

    # ========== 長野県 ==========
    "1368082550010": {"name": "美和ダム", "pref": "長野県", "river": "天竜川", "operator_group": "国", "lat": 35.7000, "lon": 138.0333},
    "1368082550020": {"name": "高遠ダム", "pref": "長野県", "river": "天竜川", "operator_group": "民間", "lat": 35.7833, "lon": 138.0500},
    "1368082550030": {"name": "箕輪ダム", "pref": "長野県", "river": "天竜川", "operator_group": "長野県", "lat": 35.8333, "lon": 137.9833},

    # ========== 岐阜県 ==========
    "1368081550010": {"name": "川浦ダム", "pref": "岐阜県", "river": "木曽川", "operator_group": "岐阜県", "lat": 35.6833, "lon": 137.3333},
    "1368081550020": {"name": "大井ダム", "pref": "岐阜県", "river": "木曽川", "operator_group": "民間", "lat": 35.4167, "lon": 137.4500},

    # ========== 静岡県 ==========
    "1368081050030": {"name": "佐久間ダム", "pref": "静岡県", "river": "天竜川", "operator_group": "民間", "lat": 34.9833, "lon": 137.7167},
    "1368081050040": {"name": "秋葉ダム", "pref": "静岡県", "river": "天竜川", "operator_group": "民間", "lat": 34.8667, "lon": 137.8500},
    "1368080950010": {"name": "気田川ダム", "pref": "静岡県", "river": "天竜川", "operator_group": "静岡県", "lat": 34.9667, "lon": 137.8833},

    # ========== 愛知県 ==========
    "1368081250010": {"name": "宇連ダム", "pref": "愛知県", "river": "豊川", "operator_group": "愛知県", "lat": 34.9667, "lon": 137.6167},
    "1368081250020": {"name": "大島ダム", "pref": "愛知県", "river": "豊川", "operator_group": "愛知県", "lat": 34.9833, "lon": 137.5667},

    # ========== 三重県 ==========
    "1368083250010": {"name": "蓮ダム", "pref": "三重県", "river": "�櫛田川", "operator_group": "三重県", "lat": 34.4333, "lon": 136.2000},
    "1368083250020": {"name": "君ヶ野ダム", "pref": "三重県", "river": "雲出川", "operator_group": "三重県", "lat": 34.5500, "lon": 136.2333},

    # ========== 滋賀県 ==========
    "1368083450010": {"name": "永源寺ダム", "pref": "滋賀県", "river": "淀川", "operator_group": "滋賀県", "lat": 35.1167, "lon": 136.3833},
    "1368083450020": {"name": "姉川ダム", "pref": "滋賀県", "river": "淀川", "operator_group": "滋賀県", "lat": 35.5167, "lon": 136.2833},

    # ========== 京都府 ==========
    "1368083550010": {"name": "大野ダム", "pref": "京都府", "river": "由良川", "operator_group": "京都府", "lat": 35.3833, "lon": 135.4000},
    "1368083550020": {"name": "畑川ダム", "pref": "京都府", "river": "由良川", "operator_group": "京都府", "lat": 35.4667, "lon": 135.2833},

    # ========== 大阪府 ==========
    "1368083450010": {"name": "狭山池", "pref": "大阪府", "river": "淀川", "operator_group": "大阪府", "lat": 34.5000, "lon": 135.5500},

    # ========== 兵庫県 ==========
    "1368083850010": {"name": "青野ダム", "pref": "兵庫県", "river": "加古川", "operator_group": "兵庫県", "lat": 34.9333, "lon": 135.0667},
    "1368083850020": {"name": "呑吐ダム", "pref": "兵庫県", "river": "加古川", "operator_group": "兵庫県", "lat": 35.0167, "lon": 134.9333},
    "1368083850030": {"name": "糀屋ダム", "pref": "兵庫県", "river": "加古川", "operator_group": "兵庫県", "lat": 35.0833, "lon": 134.8667},

    # ========== 奈良県 ==========
    "1368083450010": {"name": "大迫ダム", "pref": "奈良県", "river": "淀川", "operator_group": "奈良県", "lat": 34.3500, "lon": 135.8333},
    "1368083450020": {"name": "白川ダム", "pref": "奈良県", "river": "紀の川", "operator_group": "奈良県", "lat": 34.2333, "lon": 135.8000},

    # ========== 和歌山県 ==========
    "1368083650010": {"name": "二川ダム", "pref": "和歌山県", "river": "紀の川", "operator_group": "和歌山県", "lat": 34.1833, "lon": 135.5667},
    "1368083650020": {"name": "椿山ダム", "pref": "和歌山県", "river": "熊野川", "operator_group": "国", "lat": 33.8333, "lon": 135.8167},

    # ========== 鳥取県 ==========
    "1368083850010": {"name": "殿ダム", "pref": "鳥取県", "river": "千代川", "operator_group": "国", "lat": 35.3333, "lon": 134.1833},
    "1368083850020": {"name": "百谷ダム", "pref": "鳥取県", "river": "天神川", "operator_group": "鳥取県", "lat": 35.4167, "lon": 133.6333},

    # ========== 島根県 ==========
    "1368084050010": {"name": "三瓶ダム", "pref": "島根県", "river": "江の川", "operator_group": "島根県", "lat": 35.1167, "lon": 132.5833},

    # ========== 岡山県 ==========
    "1368084250010": {"name": "旭川ダム", "pref": "岡山県", "river": "旭川", "operator_group": "岡山県", "lat": 35.1167, "lon": 133.8000},
    "1368084250020": {"name": "湯原ダム", "pref": "岡山県", "river": "旭川", "operator_group": "民間", "lat": 35.2000, "lon": 133.6333},

    # ========== 広島県 ==========
    "1368084450010": {"name": "弥栄ダム", "pref": "広島県", "river": "小瀬川", "operator_group": "国", "lat": 34.3500, "lon": 132.1167},
    "1368084450020": {"name": "椋梨ダム", "pref": "広島県", "river": "芦田川", "operator_group": "広島県", "lat": 34.7167, "lon": 133.0500},

    # ========== 山口県 ==========
    "1368084650010": {"name": "末武川ダム", "pref": "山口県", "river": "末武川", "operator_group": "山口県", "lat": 34.0500, "lon": 131.5833},
    "1368084650020": {"name": "厚東川ダム", "pref": "山口県", "river": "厚東川", "operator_group": "山口県", "lat": 34.0667, "lon": 131.2667},

    # ========== 徳島県 ==========
    "1368084850010": {"name": "正木ダム", "pref": "徳島県", "river": "那賀川", "operator_group": "徳島県", "lat": 33.8667, "lon": 134.3333},

    # ========== 香川県 ==========
    "1368084950010": {"name": "内海ダム", "pref": "香川県", "river": "内海川", "operator_group": "香川県", "lat": 34.3000, "lon": 134.1333},
    "1368084950020": {"name": "府中ダム", "pref": "香川県", "river": "綾川", "operator_group": "香川県", "lat": 34.2167, "lon": 133.9667},

    # ========== 愛媛県 ==========
    "1368085150010": {"name": "面河ダム", "pref": "愛媛県", "river": "仁淀川", "operator_group": "愛媛県", "lat": 33.7167, "lon": 133.0167},
    "1368085150020": {"name": "玉川ダム", "pref": "愛媛県", "river": "蒼社川", "operator_group": "愛媛県", "lat": 33.9667, "lon": 133.0333},

    # ========== 高知県 ==========
    "1368084950010": {"name": "鏡ダム", "pref": "高知県", "river": "物部川", "operator_group": "高知県", "lat": 33.6833, "lon": 133.7167},
    "1368084950020": {"name": "永瀬ダム", "pref": "高知県", "river": "物部川", "operator_group": "高知県", "lat": 33.7333, "lon": 133.7667},

    # ========== 福岡県 ==========
    "1368085250010": {"name": "陣屋川ダム", "pref": "福岡県", "river": "遠賀川", "operator_group": "福岡県", "lat": 33.6833, "lon": 130.8333},
    "1368085250020": {"name": "力丸ダム", "pref": "福岡県", "river": "矢部川", "operator_group": "福岡県", "lat": 33.2500, "lon": 130.8333},

    # ========== 佐賀県 ==========
    "1368085650010": {"name": "北山ダム", "pref": "佐賀県", "river": "嘉瀬川", "operator_group": "佐賀県", "lat": 33.3667, "lon": 130.2333},

    # ========== 長崎県 ==========
    "1468085850010": {"name": "鹿尾川ダム", "pref": "長崎県", "river": "鹿尾川", "operator_group": "長崎県", "lat": 32.9667, "lon": 129.8500},

    # ========== 熊本県 ==========
    "1368085950010": {"name": "氷川ダム", "pref": "熊本県", "river": "氷川", "operator_group": "熊本県", "lat": 32.5833, "lon": 130.7833},
    "1368085950020": {"name": "上津浦川ダム", "pref": "熊本県", "river": "菊池川", "operator_group": "熊本県", "lat": 33.0333, "lon": 130.9167},

    # ========== 大分県 ==========
    "1368086050010": {"name": "稲葉ダム", "pref": "大分県", "river": "大野川", "operator_group": "大分県", "lat": 32.9667, "lon": 131.5500},
    "1368086050020": {"name": "芹川ダム", "pref": "大分県", "river": "大野川", "operator_group": "大分県", "lat": 33.0833, "lon": 131.5833},

    # ========== 宮崎県 ==========
    "1368086250010": {"name": "上椎葉ダム", "pref": "宮崎県", "river": "耳川", "operator_group": "民間", "lat": 32.4833, "lon": 131.2000},
    "1368086250020": {"name": "日南ダム", "pref": "宮崎県", "river": "広渡川", "operator_group": "宮崎県", "lat": 31.6833, "lon": 131.3833},

    # ========== 鹿児島県 ==========
    "1468086450010": {"name": "曽木の滝分水路", "pref": "鹿児島県", "river": "川内川", "operator_group": "鹿児島県", "lat": 31.9167, "lon": 130.6500},
}


def main():
    """メイン処理"""
    OUT = pathlib.Path("public/data/local_dams.json")

    print("各自治体管理ダムのメタデータを作成中...")

    output = []
    for station_id, info in LOCAL_DAMS.items():
        output.append({
            "station_id": station_id,
            "dam_id": f"local_{station_id}",
            "name": info["name"],
            "pref": info["pref"],
            "river": info.get("river", ""),
            "operator_group": info["operator_group"],
            "lat": info["lat"],
            "lon": info["lon"],
            "data_source": "川の防災情報（国土交通省）",
        })

    OUT.parent.mkdir(parents=True, exist_ok=True)
    OUT.write_text(json.dumps(output, ensure_ascii=False, indent=2), encoding="utf-8")

    print(f"\n✓ {len(output)}件のダムメタデータを作成しました")
    print(f"✓ {OUT} に保存しました")
    print("\n注: 実際のデータ取得はfetch_mlit_dams.pyで実行されます")


if __name__ == "__main__":
    main()
